version: 1
disable_existing_loggers: false

formatters:
  standard:
    format: "%(asctime)s [%(levelname)s] %(name)s: %(message)s"
    datefmt: "%Y-%m-%d %H:%M:%S"
    
  json:
    format: "%(asctime)s"
    datefmt: "%Y-%m-%dT%H:%M:%S.%fZ"
    class: "src.utils.logger.JSONFormatter"
    
  desync:
    format: "%(asctime)s [DESYNC] %(message)s"
    datefmt: "%Y-%m-%dT%H:%M:%S.%fZ"

handlers:
  console:
    class: logging.StreamHandler
    level: INFO
    formatter: standard
    stream: ext://sys.stdout
    
  system_file:
    class: logging.handlers.RotatingFileHandler
    level: INFO
    formatter: standard
    filename: logs/system/monitor.log
    maxBytes: 10485760  # 10MB
    backupCount: 5
    
  metrics_file:
    class: logging.handlers.TimedRotatingFileHandler
    level: DEBUG
    formatter: json
    filename: logs/metrics/metrics.log
    when: midnight
    interval: 1
    backupCount: 7
    
  desync_file:
    class: logging.handlers.TimedRotatingFileHandler
    level: DEBUG
    formatter: desync
    filename: logs/desyncs/desync_events.log
    when: midnight
    interval: 1
    backupCount: 90

loggers:
  # Root logger
  "":
    level: INFO
    handlers: [console, system_file]
    propagate: false
    
  # Main application logger
  ethereum_node_monitor:
    level: INFO
    handlers: [console, system_file]
    propagate: false
    
  # Sync monitoring logger
  sync_monitor:
    level: INFO
    handlers: [console, system_file]
    propagate: false
    
  # Metrics collection logger
  metrics_collector:
    level: INFO
    handlers: [console, metrics_file]
    propagate: false
    
  # Desync events logger
  desync_logger:
    level: DEBUG
    handlers: [console, desync_file, system_file]
    propagate: false
    
  # Correlation analysis logger
  correlation_engine:
    level: INFO
    handlers: [console, system_file]
    propagate: false
    
  # IPC communication logger
  ipc_client:
    level: INFO
    handlers: [console, system_file]
    propagate: false
    
  # Prometheus client logger
  prometheus_client:
    level: INFO
    handlers: [console, metrics_file]
    propagate: false

# External library loggers
  urllib3:
    level: WARNING
    handlers: [system_file]
    propagate: false
    
  requests:
    level: WARNING
    handlers: [system_file]
    propagate: false